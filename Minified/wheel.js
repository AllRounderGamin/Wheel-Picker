const WHEELTEMP=document.createElement("template");WHEELTEMP.innerHTML='<link href="./stylesheet.css" rel="stylesheet">\n    <div class="container">\n        <div class="wheelContainer">\n            <canvas class="wheelCanvas" width="800" height="800"></canvas>\n            <canvas class="pointerCanvas" width="800" height="800"></canvas>\n        </div>\n        <div class="buttonGroup">\n            <button class="spinButton" type="button">Spin Wheel</button>\n            <button class="deleteButton" type="button">Delete Wheel</button>\n            <button class="settingsButton" type="button">Settings</button>\n        </div>\n    </div>';class fortuneWheel extends HTMLElement{constructor(){super(),this.CA=0,this.C=[],this.I=[],this.initialise()}initialise(){this.S=this.attachShadow({mode:"open"}),this.S.appendChild(WHEELTEMP.content.cloneNode(!0)),this.W=this.S.querySelector(".wheelCanvas"),this.WC=this.W.getContext("2d"),this.S.querySelector(".spinButton").addEventListener("click",this.spinWheel.bind(this)),this.S.querySelector(".deleteButton").addEventListener("click",this.deleteWheel.bind(this)),this.drawPointer()}static get observedAttributes(){return["customising"]}attributeChangedCallback(){this.getValues(),this.drawWheel()}getValues(){this.I=JSON.parse(this.getAttribute("items")),this.C=JSON.parse(this.getAttribute("colors"))}drawWheel(){this.WC.clearRect(0,0,this.W.height,this.W.width),this.AS=2*Math.PI/this.I.length;let a=0;this.WC.font="64px serif",this.WC.textBaseline="middle",this.WC.lineWidth=5;for(let b=0;b<this.I.length;b++)this.WC.beginPath(),this.WC.arc(400,400,315,a-Math.PI/2,a+this.AS-Math.PI/2),this.WC.stroke(),this.WC.lineTo(400,400),this.WC.fillStyle=this.C[b],this.WC.fill(),this.WC.closePath(),a+=this.AS,this.I.length<10&&(this.WC.save(),this.WC.translate(this.W.width/2,this.W.height/2),this.WC.rotate(-Math.PI/2+(a-this.AS/2)),this.WC.fillStyle="black",this.WC.fillText("     "+this.I[b],0,0,260),this.WC.restore())}drawPointer(){this.P=this.S.querySelector(".pointerCanvas"),this.PC=this.P.getContext("2d"),this.PC.fillStyle="black",this.PC.beginPath(),this.PC.moveTo(790,370),this.PC.lineTo(790,430),this.PC.lineTo(730,400),this.PC.fill()}spinWheel(){let a=1080+360*Math.random();this.W.style.setProperty("--s",this.CA+"deg"),this.W.style.setProperty("--e",Math.floor(this.CA+a)+"deg"),this.W.classList.add("active"),this.CA=Math.floor(this.CA+a)%360,this.W.style.setProperty("--r",this.CA+"deg"),this.W.addEventListener("animationend",this.verifyAnswer.bind(this),{once:!0})}verifyAnswer(){this.W.classList.remove("active");let b=Math.floor((450-this.CA)%360*Math.PI/180/this.AS);this.PC.clearRect(0,600,800,200),this.PC.font="64px serif",this.PC.lineWidth=3;let a="Winner is "+this.I[b];this.PC.strokeText(a,400-this.PC.measureText(a).width/2,770,720),this.PC.fillStyle=this.C[b],this.PC.fillText(a,400-this.PC.measureText(a).width/2,770,720)}deleteWheel(){let a=JSON.parse(localStorage.getItem("wheels"));for(let c of a)c.id===this.getAttribute("id")&&a.splice(a.indexOf(c),1);let b=document.querySelector("#settingsArea");for(;b.hasChildNodes();)b.removeChild(b.firstChild);localStorage.setItem("wheels",JSON.stringify(a)),this.shadowRoot.host.remove()}}customElements.define("wheel-picker",fortuneWheel)
